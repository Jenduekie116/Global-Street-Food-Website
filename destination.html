<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Global Street Food ‚Äî Destination</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }

        header {
            text-align: center;
            padding: 1rem;
            background: #f5f5f5;
        }

        #map {
            height: 90vh;
            width: 100%;
        }

        .leaflet-tooltip {
            font-weight: bold;
        }
    </style>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="destination.css">
</head>

<body>
    <!-- Topbar -->
  <div class="topbar">
    <!-- Search Bar -->
    <div class="search-bar">
      <img src="image/search.png" alt="Search Icon" class="search-icon">
      <input type="text" placeholder="Search ...">
    </div>

    <!-- Logo -->
    <div class="logo">
      <img src="image/logo.png" alt="Global Street Food Logo">
      <span class="logo-text">Global Street Food</span>
    </div>

    <!-- User Section -->
    <div class="user-section">
      <span class="login-text">Log in</span>
      <img src="image/user.png" alt="User Icon" class="user-icon">
    </div>
  </div>

  <!-- Navigation Bar -->
  <nav class="navbar">
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="destination.html">Destination</a>
    <a href="ingredient.html">Ingredient</a>
    <a href="starred.html">Saved food</a>
    <a href="contact.html">Contact</a>
  </nav>
  
    <header>
        <h1>üåç Choose Your Destination</h1>
        <p>Click a country or type a country name to explore its street food!</p>
        <!-- Search bar -->
        <div style="margin-top:1em;">
            <input type="text" id="countrySearch" placeholder="Type a country name..." style="padding:0.5em; width:220px;">
            <button id="searchBtn" style="padding:0.5em;">Search</button>
            <span id="searchError" style="color:red; margin-left:1em;"></span>
        </div>
    </header>

    <div id="map"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        // Mapping dictionary
        const countryToArea = {
            "United States of America": "American",
            "United Kingdom": "British",
            "Russia": "Russian",
            "China": "Chinese",
            "Japan": "Japanese",
            "Mexico": "Mexican",
            "India": "Indian",
            "Malaysia": "Malaysian",
            "Spain": "Spanish",
            "France": "French",
            "Italy": "Italian",
            "Thailand": "Thai",
            "Turkey": "Turkish",
            "Vietnam": "Vietnamese",
            "Canada": "Canadian",
            "Ireland": "Irish",
            "Jamaica": "Jamaican",
            "Morocco": "Moroccan",
            "Greece": "Greek",
            "Egypt": "Egyptian"
        };

        // Create map and set default view (world)
        const map = L.map('map').setView([20, 0], 2);

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        // Load GeoJSON (world countries)
        fetch('data/countries.geojson')
            .then(res => res.json())
            .then(data => {
                L.geoJSON(data, {
                    style: {
                        color: "#555",
                        weight: 1,
                        fillColor: "#cce5ff",
                        fillOpacity: 0.5
                    },
                    onEachFeature: (feature, layer) => {
                        const countryName = feature.properties.ADMIN || feature.properties.name;

                        // Show tooltip on hover
                        layer.bindTooltip(countryName, { sticky: true });

                        // Hover style with random color
                        layer.on('mouseover', () => {
                            // Generate a random hex color
                            const randomColor = "#" + Math.floor(Math.random() * 16777215).toString(16);
                            layer.setStyle({ fillColor: randomColor, fillOpacity: 0.7 });
                        });

                        layer.on('mouseout', () => {
                            layer.setStyle({ fillColor: "#cce5ff", fillOpacity: 0.5 }); // back to default
                        });


                        // Click handler
                        layer.on('click', () => {
                            const area = countryToArea[countryName] || countryName; // fallback if not mapped
                            window.location.href = `foods/search.html?country=${encodeURIComponent(area)}`;
                        });
                    }
                }).addTo(map);
            })
            .catch(err => console.error("GeoJSON load error:", err));

        // Search bar logic
        document.getElementById('searchBtn').onclick = function () {
            const input = document.getElementById('countrySearch').value.trim();
            const errorSpan = document.getElementById('searchError');
            errorSpan.textContent = "";
            if (!input) return;

            // Case-insensitive match
            const foundKey = Object.keys(countryToArea).find(
                k => k.toLowerCase() === input.toLowerCase()
            );
            const area = foundKey ? countryToArea[foundKey] : null;

            if (area) {
                window.location.href = `foods/search.html?country=${encodeURIComponent(area)}`;
            } else {
                errorSpan.textContent = "Country not found or not supported.";
            }
        };
    </script>

    <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <nav class="footer-nav">
        <a href="about.html" class="footer-link">About us</a>
        <a href="destination.html" class="footer-link">Site map</a>
        <a href="privacy.html" class="footer-link">Privacy</a>
        <a href="terms&condition.html" class="footer-link">Terms & conditions</a>
      </nav>
      <div class="footer-copy">
        ¬© 2025 Global Street Food - All Rights Reserved
      </div>
    </div>
  </footer>

</body>

</html>